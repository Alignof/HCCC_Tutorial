# ラベルとループ

さて，実用的なプログラムを書くためには，条件分岐やループがないと生きていけませんね．

ということで，このチュートリアルの締めとして，それらをアセンブリで書く方法について説明していきます．

## ラベル

今回重要になってくるのは，[section2: アセンブリの基礎](/sections/section2_BasicOfAssembly.md) でチラッと登場した「ラベル」という概念です．

section 2 で登場したアセンブリをもう一度見てみましょう．

```
.intel_syntax noprefix
.globl main

main:
    push    rbp
    mov     rbp, rsp
    mov     eax, 0
    pop     rbp
    ret
```

`main:` と書くことで `main` という名前のラベルを作り，そしてそれを外部から参照するために `.globl main` をつけていたのでしたね．
このように，ラベルを使うことでアセンブリ内の位置を参照できるようになります．
mainラベルを置くことでcallを使ってmain関数（の書かれているアセンブリ群の先頭）に飛ぶことができるのも
ラベルという機能があるおかげなのです．

## ジャンプ命令とループ
さて，大抵のアーキテクチャにはジャンプ命令（もしくはブランチ命令）が存在します．
コンピュータはPC（プログラムカウンタ）が指している番地に存在するデータを命令と解釈して順に実行しますが，
ジャンプ命令はこのPCを今の値から増減させたり，ある値にセットしたりすることで実行する命令を変更します．

言い換えれば，ラベルを使ってアセンブリ内の所望の位置に飛ぶことができるということですが，
これは順方向に飛ぶことで後に続く処理をスキップしたり，逆方向に飛ぶことでループを実現したりすることができるということです．

単純な例を示してみます．
```
.intel_syntax noprefix
.globl main

main:
    push    rbp
    mov     rbp, rsp

LOOP:
    jmp LOOP

    mov     eax, 0

    pop     rbp
    ret
```

処理は上から下に進みますが，飛ぶ先のラベルである`LOOP`はjmp命令の前にあるのでこれは逆方向のジャンプです．
jmp命令までたどり着くとjmp命令の前に飛びます．つまり，これは無限ループを表しています．

無限ループが実現できるようになったのは大きな進歩ですが，これではいつまで経ってもプログラムが終了しません．
ここで今度は順方向のジャンプを使います．


# 次のセクション
[section9: 条件分岐](/sections/section9_Branching.md)

